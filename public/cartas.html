<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.6.1/font/bootstrap-icons.css">
    
    <title>Cartas</title>
</head>
<body>
    <div class="container" >
        <div class="row align-items-center" >
            <div class="col">
                <div>Jogador 1</div>
                <div class="card" style="width: 80px; height: 100px; background-image: url('/public/assets/images/baralho/fundo.svg'); background-size: auto;">
                    <div id="jog1"></div>
                </div>
                <div><button onclick="jogada1()">Jogar carta</button></div>
            </div>
            <div class="col">
                <div id="sequencia"></div>
                <div class="card" style="width: 80px; height: 100px;">
                    <div class="card-body">
                        <h5 class="card-title" id="valorMesa">1</h5>
                        <p class="card-text text-center" id="naipeMesa"><img src="/public/assets/images/baralho/copas.svg" alt="" width="30px"></p>
                    </div>
                </div>
                <div id="mensagem"></div>
            </div>
            <div class="col">
                <div>Jogador 2</div>
                <div class="card" style="width: 80px; height: 100px; background-image: url('/public/assets/images/baralho/fundo.svg'); background-size: auto;">
                    <div id="jog2"></div>
                </div>
                <div><button onclick="jogada2()">Jogar carta</button></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script>
        var jog1 = document.getElementById("jog1");
        var jog2 = document.getElementById("jog2");
        var valorMesa = document.getElementById("valorMesa");
        var naipeMesa = document.getElementById("naipeMesa");
        var mensagem = document.getElementById("mensagem");
        var sequencia = document.getElementById("sequencia");
        var jogoRodando = true;
        var descarte;
        var jogadas = 2;
        var vez = 1;
        var seq = -1;

        var carta = (v, n) => ({
            valor: v,
            naipe: n
        });

        var c = carta(1, "paus");
        var baralho = [];
        for (let i = 1; i <= 13; i++) {
            baralho.push(carta(i, "paus"));
            baralho.push(carta(i, "espadas"));
            baralho.push(carta(i, "ouros"));
            baralho.push(carta(i, "copas"));
        }
        var cartas1 = [...baralho];
        var cartas2 = [...baralho];

        function randOrd(){
            return (Math.round(Math.random())-0.5);
        }
        cartas1.sort(randOrd);
        cartas2.sort(randOrd);
        atualizaMesa();

        function atualizaMesa() {
            jog1.innerHTML = "Cartas " + cartas1.length;
            jog2.innerHTML = "Cartas " + cartas2.length;
            mensagem.innerHTML = "Vez do jogardor " + vez;
            ++seq;
            if (seq > 13) seq = 1;
            sequencia.innerHTML = seq;
        }

        function jogada1() {
            if (vez == 1 && jogoRodando) {
                descarte = cartas1.pop();
                criarCarta(descarte);
                jog1.innerHTML = "Cartas " + cartas1.length;
                mudarJogada();
            }
        }

        function jogada2() {
            if (vez == 2 && jogoRodando) {
                descarte = cartas2.pop();
                criarCarta(descarte);
                jog2.innerHTML = "Cartas " + cartas2.length;
                mudarJogada();
            }
        }
        function criarCarta(c) {
            valorMesa.innerHTML = c.valor;
            var valor = c.valor;
            if (valor === 1) valor = "A";
            if (valor === 11) valor = "J";
            if (valor === 12) valor = "Q";
            if (valor === 13) valor = "K";
            valorMesa.innerHTML = valor;
            var imgNaipe;
            if (c.naipe === "copas") imgNaipe = '<img src="/public/assets/images/baralho/copas.svg" alt="" width="30px">';
            if (c.naipe === "paus") imgNaipe = '<img src="/public/assets/images/baralho/paus.svg" alt="" width="30px">';
            if (c.naipe === "espadas") imgNaipe = '<img src="/public/assets/images/baralho/espadas.svg" alt="" width="30px">';
            if (c.naipe === "ouros") imgNaipe = '<img src="/public/assets/images/baralho/ouros.svg" alt="" width="30px">';
            naipeMesa.innerHTML = imgNaipe;
        }
        function mudarJogada() {
            vez++;
            if (vez > jogadas) vez = 1;
            atualizaMesa();
        }

        window.addEventListener("keydown", teclasApertadas, false);

        function teclasApertadas(evt) {
            if (evt.key == "a") {
                jogada1();
            }
            if (evt.key == "l") {
                jogada2();
            }
            if (evt.key == "s") {
                bater(1);
            }
            if (evt.key == "k") {
                bater(2);
            }
        }

        function bater(jogador) {
            if (jogoRodando) {
                if (seq === descarte.valor) {
                    mensagem.innerHTML = "Jogador " + jogador + " venceu"
                } else {
                    mensagem.innerHTML = "Jogador " + jogador + " perdeu"
                }
                jogoRodando = false;
            }
        }
    </script>
</body>
</html>
